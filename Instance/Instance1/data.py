from pymatgen.io.vasp import Poscar
from pymatgen.symmetry.analyzer import SpacegroupAnalyzer

from cams.propressing.electro import ChgCar

a = [0, 1028, 108, 138, 168, 198, 227, 257, 289, 318, 348, 378, 408, 438, 468, 498, 527, 557, 587, 616, 646, 676, 705,
     735,
     766, 796, 825, 855, 885, 915, 945, 975,
     1, 1029, 109, 139, 169, 199, 228, 258, 29, 319, 349, 379, 409, 439, 469, 499, 528, 558, 588, 617, 647, 677, 706,
     736,
     767, 797, 826, 856, 886, 916, 946, 976,
     10, 103, 11, 14, 17, 2, 229, 259, 290, 32, 35, 38, 41, 44, 47, 5, 529, 559, 589, 618, 648, 678, 707, 737, 768, 798,
     827, 857, 887, 917, 947, 977,
     100, 1030, 110, 140, 170, 20, 23, 26, 291, 320, 350, 380, 410, 440, 470, 50, 53, 56, 59, 619, 649, 679, 708, 738,
     769,
     799, 828, 858, 888, 918, 948, 978,
     1000, 1031, 111, 141, 171, 200, 230, 260, 292, 321, 351, 381, 411, 441, 471, 500, 530, 560, 590, 62, 65, 68, 709,
     739,
     77, 8, 829, 859, 889, 919, 949, 979,
     1001, 1032, 112, 142, 172, 201, 231, 261, 293, 322, 352, 382, 412, 442, 472, 501, 531, 561, 591, 620, 650, 680, 71,
     74,
     770, 80, 83, 86, 89, 92, 95, 98,
     1002, 1033, 113, 143, 173, 202, 232, 262, 294, 323, 353, 384, 413, 443, 473, 502, 532, 562, 592, 621, 651, 681,
     710,
     740, 771, 800, 830, 860, 890, 920, 950, 980,
     1003, 1034, 114, 144, 174, 203, 233, 263, 295, 324, 354, 385, 414, 444, 474, 503, 533, 563, 593, 622, 652, 682,
     711,
     741, 772, 801, 831, 861, 891, 921, 951, 981,
     1004, 1035, 115, 145, 175, 204, 234, 264, 296, 325, 355, 386, 415, 445, 475, 504, 534, 564, 594, 623, 653, 683,
     712,
     742, 773, 802, 832, 862, 892, 922, 952, 982,
     1005, 1036, 116, 146, 176, 205, 235, 265, 297, 326, 356, 387, 416, 446, 476, 505, 535, 565, 595, 624, 654, 684,
     713,
     743, 774, 803, 833, 863, 893, 923, 953, 983,
     1006, 1037, 117, 147, 177, 206, 236, 266, 298, 327, 357, 388, 417, 447, 477, 506, 536, 566, 596, 625, 655, 685,
     714,
     744, 775, 804, 834, 864, 894, 924, 954, 984,
     1007, 1038, 118, 148, 178, 207, 237, 267, 299, 328, 358, 389, 418, 448, 478, 507, 537, 567, 597, 626, 656, 686,
     715,
     745, 776, 805, 835, 865, 895, 925, 955, 985,
     1008, 1039, 119, 149, 179, 208, 238, 268, 3, 329, 359, 39, 419, 449, 479, 508, 538, 568, 598, 627, 657, 687, 716,
     746,
     777, 806, 836, 866, 896, 926, 956, 986,
     1009, 104, 12, 15, 18, 209, 239, 269, 30, 33, 36, 390, 42, 45, 48, 509, 539, 569, 599, 628, 658, 688, 717, 747,
     778,
     807, 837, 867, 897, 927, 957, 987,
     1010, 1040, 120, 150, 180, 21, 24, 27, 300, 330, 360, 391, 420, 450, 480, 51, 54, 57, 6, 629, 659, 689, 718, 748,
     779,
     808, 838, 868, 898, 928, 958, 988,
     1011, 1041, 121, 151, 181, 210, 240, 270, 301, 331, 361, 392, 421, 451, 481, 510, 540, 570, 60, 63, 66, 69, 719,
     749,
     78, 809, 839, 869, 899, 929, 959, 989,
     1012, 1042, 122, 152, 182, 211, 241, 271, 302, 332, 362, 393, 422, 452, 482, 511, 541, 571, 600, 630, 660, 690, 72,
     75,
     780, 81, 84, 87, 9, 93, 96, 990,
     1013, 1043, 123, 153, 183, 212, 242, 272, 303, 333, 363, 394, 423, 453, 483, 512, 542, 572, 601, 631, 661, 691,
     720,
     750, 781, 810, 840, 870, 90, 930, 960, 991,
     1014, 1044, 124, 154, 184, 213, 243, 273, 304, 334, 364, 395, 424, 454, 484, 513, 543, 573, 602, 632, 662, 692,
     721,
     751, 782, 811, 841, 871, 900, 931, 961, 992,
     1015, 1045, 125, 155, 185, 214, 244, 274, 305, 335, 365, 396, 425, 455, 485, 514, 544, 574, 603, 633, 663, 693,
     722,
     752, 783, 812, 842, 872, 901, 932, 962, 993,
     1016, 1046, 126, 156, 186, 215, 245, 275, 306, 336, 366, 397, 426, 456, 486, 515, 545, 575, 604, 634, 664, 694,
     723,
     753, 784, 813, 843, 873, 903, 933, 963, 994,
     1017, 1047, 127, 157, 187, 216, 246, 276, 307, 337, 367, 398, 427, 457, 487, 516, 546, 576, 605, 635, 665, 695,
     724,
     754, 785, 814, 844, 874, 904, 934, 964, 995,
     1018, 1048, 128, 158, 188, 217, 247, 277, 308, 338, 368, 399, 428, 458, 488, 517, 547, 577, 606, 636, 666, 696,
     725,
     756, 786, 815, 845, 875, 905, 935, 965, 996,
     1019, 1049, 129, 159, 189, 218, 248, 278, 309, 339, 369, 4, 429, 459, 489, 518, 548, 578, 607, 637, 667, 697, 726,
     757,
     787, 816, 846, 876, 906, 936, 966, 997,
     102, 105, 13, 16, 19, 219, 249, 28, 31, 34, 37, 40, 43, 46, 49, 519, 549, 579, 608, 638, 668, 698, 727, 758, 788,
     817,
     847, 877, 907, 937, 967, 998,
     1020, 1050, 130, 160, 190, 22, 25, 280, 310, 340, 370, 400, 430, 460, 490, 52, 55, 58, 609, 639, 669, 699, 728,
     759,
     789, 818, 848, 878, 908, 938, 968, 999,
     1021, 1051, 131, 161, 191, 220, 250, 282, 311, 341, 371, 401, 431, 461, 491, 520, 550, 580, 61, 64, 67, 7, 729, 76,
     79,
     819, 849, 879, 909, 939, 969,
     1022, 1052, 132, 162, 192, 221, 251, 283, 312, 342, 372, 402, 432, 462, 492, 521, 551, 581, 610, 640, 670, 70, 73,
     760,
     790, 82, 85, 88, 91, 94, 97,
     1023, 1053, 133, 163, 193, 222, 252, 284, 313, 343, 373, 403, 433, 463, 493, 522, 552, 582, 611, 641, 671, 700,
     730,
     761, 791, 820, 850, 880, 910, 940, 970,
     1024, 1054, 134, 164, 194, 223, 253, 285, 314, 344, 374, 404, 434, 464, 494, 523, 553, 583, 612, 642, 672, 701,
     731,
     762, 792, 821, 851, 881, 911, 941, 971,
     1025, 1055, 135, 165, 195, 224, 254, 286, 315, 345, 375, 405, 435, 465, 495, 524, 554, 584, 613, 643, 673, 702,
     732,
     763, 793, 822, 852, 882, 912, 942, 972,
     1026, 106, 136, 166, 196, 225, 255, 287, 316, 346, 376, 406, 436, 466, 496, 525, 555, 585, 614, 644, 674, 703, 733,
     764, 794, 823, 853, 883, 913, 943, 973,
     1027, 107, 137, 167, 197, 226, 256, 288, 317, 347, 377, 407, 437, 467, 497, 526, 556, 586, 615, 645, 675, 704, 734,
     765, 795, 824, 854, 884, 914, 944, 974,
     ]

b = [0, 103, 109, 14, 17, 200, 231, 261, 292, 320, 354, 385, 415, 446, 478, 506, 535, 564, 595, 625, 654, 684, 713, 743,
     774, 804, 838, 87, 900, 931, 963, 995,
     1, 1030, 11, 140, 170, 201, 232, 262, 293, 321, 355, 386, 416, 447, 479, 507, 536, 565, 596, 626, 655, 685, 714,
     744, 776, 806, 839, 870, 901, 932, 964, 996,
     10, 1031, 110, 141, 171, 202, 233, 263, 294, 322, 356, 387, 417, 448, 48, 508, 537, 566, 597, 627, 656, 686, 715,
     745, 777, 807, 84, 871, 903, 933, 965, 997,
     100, 1032, 111, 142, 172, 203, 234, 264, 295, 323, 357, 388, 419, 449, 480, 509, 538, 567, 598, 628, 657, 687, 716,
     746, 778, 808, 840, 873, 904, 934, 968, 998,
     1000, 1033, 112, 143, 173, 204, 235, 265, 296, 324, 358, 389, 42, 45, 481, 51, 539, 568, 599, 629, 658, 688, 717,
     747, 779, 809, 841, 874, 905, 935, 969, 999,
     1001, 1034, 113, 144, 174, 205, 236, 266, 297, 325, 359, 39, 420, 450, 482, 510, 54, 569, 6, 63, 659, 689, 718,
     748, 78, 842, 875, 906, 936, 97,
     1002, 1035, 114, 145, 175, 206, 237, 267, 298, 326, 36, 390, 421, 451, 483, 511, 540, 57, 60, 630, 66, 69, 719,
     749, 780, 810, 843, 876, 907, 937, 970,
     1003, 1036, 115, 146, 176, 207, 239, 268, 299, 327, 360, 391, 422, 452, 484, 512, 541, 570, 600, 631, 660, 690,
     720, 750, 781, 811, 845, 877, 908, 938, 971,
     1005, 1037, 116, 147, 177, 209, 24, 269, 3, 328, 361, 392, 423, 453, 485, 513, 542, 572, 601, 632, 661, 691, 721,
     751, 782, 812, 846, 878, 909, 939, 972,
     1006, 1038, 117, 148, 179, 21, 240, 27, 30, 329, 362, 393, 424, 454, 486, 514, 543, 573, 603, 633, 662, 692, 722,
     752, 783, 814, 847, 879, 91, 94, 973,
     1007, 1039, 118, 149, 18, 210, 241, 270, 300, 331, 363, 395, 425, 455, 487, 515, 544, 574, 604, 634, 663, 693, 723,
     753, 784, 816, 848, 88, 910, 940, 974,
     1008, 104, 119, 15, 180, 211, 242, 271, 301, 332, 364, 396, 426, 456, 488, 516, 545, 575, 605, 635, 664, 694, 724,
     754, 785, 817, 849, 880, 911, 941, 975,
     1009, 1040, 12, 150, 181, 212, 243, 272, 302, 333, 365, 397, 427, 457, 489, 517, 546, 576, 606, 636, 665, 696, 725,
     756, 786, 818, 85, 881, 912, 942, 976,
     1010, 1041, 120, 151, 182, 213, 244, 273, 303, 334, 366, 398, 428, 458, 49, 518, 547, 577, 607, 637, 666, 697, 726,
     757, 787, 82, 850, 882, 913, 943, 977,
     1011, 1042, 121, 152, 183, 214, 245, 274, 304, 335, 367, 399, 429, 459, 490, 519, 548, 578, 608, 638, 667, 698,
     727, 758, 788, 820, 851, 883, 914, 944, 978,
     1012, 1043, 122, 153, 184, 215, 246, 275, 305, 336, 368, 4, 43, 46, 491, 52, 549, 579, 609, 639, 668, 699, 728,
     759, 789, 821, 852, 884, 915, 945, 979,
     1013, 1044, 123, 154, 185, 216, 247, 276, 306, 337, 369, 40, 430, 460, 492, 520, 55, 58, 61, 64, 669, 7, 729, 76,
     79, 822, 853, 886, 916, 946, 98,
     1014, 1045, 124, 155, 187, 217, 248, 277, 307, 338, 37, 400, 431, 461, 493, 521, 550, 580, 610, 640, 67, 70, 73,
     760, 790, 823, 854, 887, 917, 947, 980,
     1015, 1046, 125, 156, 188, 218, 249, 278, 308, 339, 370, 401, 433, 462, 494, 522, 551, 581, 611, 641, 671, 700,
     730, 761, 791, 824, 855, 888, 918, 948, 981,
     1018, 1047, 126, 157, 189, 219, 25, 28, 309, 34, 371, 402, 434, 463, 495, 523, 552, 582, 612, 642, 672, 701, 731,
     762, 792, 825, 856, 889, 919, 949, 982,
     1019, 1048, 127, 158, 19, 22, 250, 280, 31, 340, 373, 403, 435, 464, 496, 524, 553, 583, 613, 643, 673, 702, 732,
     763, 793, 826, 857, 89, 92, 95, 983,
     102, 1049, 128, 159, 190, 220, 251, 282, 310, 341, 374, 404, 436, 467, 497, 525, 554, 584, 614, 644, 674, 703, 733,
     764, 795, 827, 859, 890, 920, 950, 984,
     1020, 105, 129, 16, 191, 222, 252, 283, 311, 342, 375, 405, 437, 468, 498, 526, 555, 585, 615, 645, 675, 704, 734,
     765, 796, 828, 86, 891, 921, 951, 985,
     1021, 1050, 13, 161, 192, 223, 253, 284, 312, 343, 376, 406, 438, 469, 499, 527, 556, 587, 617, 646, 676, 705, 735,
     766, 797, 829, 860, 892, 922, 953, 986,
     1022, 1051, 130, 162, 193, 224, 254, 285, 313, 344, 377, 408, 439, 47, 5, 528, 557, 588, 618, 647, 677, 706, 736,
     767, 798, 83, 861, 893, 923, 954, 987,
     1023, 1052, 131, 163, 194, 225, 255, 286, 314, 345, 378, 409, 44, 470, 50, 529, 558, 589, 619, 648, 678, 707, 737,
     768, 799, 830, 862, 894, 924, 956, 988,
     1024, 1053, 132, 164, 195, 226, 256, 287, 315, 347, 379, 41, 440, 471, 500, 53, 559, 59, 62, 649, 679, 708, 738,
     769, 8, 831, 863, 895, 925, 957, 989,
     1025, 1054, 133, 165, 196, 227, 257, 288, 316, 349, 38, 410, 441, 472, 501, 530, 56, 590, 620, 65, 68, 709, 739,
     77, 80, 832, 864, 897, 927, 958, 990,
     1026, 1055, 134, 166, 198, 228, 258, 289, 317, 35, 380, 411, 442, 473, 502, 531, 560, 591, 621, 650, 680, 71, 74,
     770, 800, 833, 865, 898, 928, 959, 991,
     1027, 106, 135, 167, 199, 229, 259, 29, 318, 350, 381, 412, 443, 475, 503, 532, 561, 592, 622, 651, 681, 710, 740,
     771, 801, 834, 866, 899, 929, 96, 992,
     1028, 107, 138, 168, 2, 23, 26, 290, 319, 351, 382, 413, 444, 476, 504, 533, 562, 593, 623, 652, 682, 711, 741,
     772, 802, 835, 868, 9, 93, 960, 993,
     1029, 108, 139, 169, 20, 230, 260, 291, 32, 352, 384, 414, 445, 477, 505, 534, 563, 594, 624, 653, 683, 712, 742,
     773, 803, 836, 869, 90, 930, 961, 994
     ]
c = set(a)-set(b)
z=0

b.sort()
space_group = ["I4/mmm","Pm-3m","Cmcm","P1","R-3c","C2/c","Immm","I4/mcm","C2/m","P2_1/m","P4mm","Pbnm"]
for i in b:
     try:
          # chgcar = ChgCar.from_file(r'/home/iap13/wcx/dielectricsPe.files/{}/CHGCAR'.format(i))
          # elfcar.plot_contour(show_mode="show")
          # print(chgcar.dim)
          chgcar = Poscar.from_file(r'/home/iap13/wcx/dielectricsPe.files/{}/CONTCAR'.format(i),check_for_POTCAR=False)
          # chgcar = Poscar.from_file(r'/home/iap13/wcx/dielectricsPe.files/{}/POSCAR'.format(i))
          if len(chgcar.site_symbols) ==3:
               sg = SpacegroupAnalyzer(chgcar.structure,angle_tolerance=2.5)
               sp = sg.get_space_group_symbol()
               # print(i,chgcar.comment,sp)

               if sp in space_group:
                   if chgcar.natoms[-1] ==3:
                        print(i, chgcar.comment, sp)
                        z+=1

     except (IndexError,ValueError,FileNotFoundError):
          # print("error",i)
          pass